(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const o=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var a=t.n(r);const l=flarum.core.compat["forum/components/IndexPage"];var s=t.n(l);const c=flarum.core.compat["forum/components/DiscussionListItem"];var n=t.n(c);const i=flarum.core.compat["tags/components/TagsPage"];var u=t.n(i);const d=flarum.core.compat["forum/components/DiscussionComposer"];var f=t.n(d);const m=flarum.core.compat["forum/components/DiscussionHero"];var g=t.n(m);const y=flarum.core.compat["tags/components/TagDiscussionModal"];var h=t.n(y);const p=flarum.core.compat["forum/components/EventPost"];var b=t.n(p);a().initializers.add("3ddario/flarum-ext-tag-color-swiss-army-knife",(function(){(0,o.extend)(s().prototype,"oncreate",(function(){if("tag"===this.attrs.routeName){var t=this.currentTag().attribute("textColor"),e=this.currentTag().attribute("color"),o=this.element.querySelector(".Hero-title"),r=this.element.querySelector(".Hero-subtitle"),a=this.element.querySelector(".IndexPage-newDiscussion");t.length>0&&(o.style.color=t,a.classList.remove("Button--tagColored"),a.style.color=t,a.style.backgroundColor=e,r&&(r.style.color=t))}})),(0,o.extend)(n().prototype,"oncreate",(function(){this.element&&this.element.querySelectorAll(".TagLabel").forEach((function(t){var e=t.firstChild,o=e.textContent.trim(),r=a().store.getBy("tags","name",o);if(r){var l=r.data.attributes;"textColor"in l&&"string"==typeof l.textColor&&l.textColor.length>0&&(t.classList.remove("colored"),e.style.color=l.textColor)}}))})),(0,o.extend)(u().prototype,"view",(function(t){t.children.forEach((function(t){t&&t.attrs&&"container"===t.attrs.className&&t.children.forEach((function(t){t&&t.attrs&&"TagsPage-content sideNavOffset"===t.attrs.className&&t.children.forEach((function(t){t&&t.attrs&&("TagTiles"===t.attrs.className?t.children.forEach((function(t){var e=t.children.find((function(t){return t&&t.attrs&&t.attrs.href}));if(e){var o=a().store.getBy("tags","slug",e.attrs.href.replace("/t/",""));o.data&&o.data.attributes&&o.data.attributes.textColor.length>0&&(t.attrs.className=t.attrs.className.replace("colored",""),t.attrs.style.background=o.data.attributes.color,t.children.forEach((function(t){t&&t.attrs&&(t.dom&&t.dom.style&&(t.dom.style.color=o.data.attributes.textColor),t.attrs.style?t.attrs.style.color=o.data.attributes.textColor:t.attrs.style={color:o.data.attributes.textColor})})))}})):"TagCloud"===t.attrs.className&&t.children.forEach((function(t){var e=t.children.find((function(t){return t&&t.attrs&&t.attrs.href}));if(e){var o=a().store.getBy("tags","slug",e.attrs.href.replace("/t/",""));o.data.attributes.textColor.length>0&&(e.attrs.className=e.attrs.className.replace("colored",""),e.children.forEach((function(t){t&&t.attrs&&(t.attrs.style?t.attrs.style.color=o.data.attributes.textColor:t.attrs.style={color:o.data.attributes.textColor})})))}})))}))}))}))})),(0,o.extend)(h().prototype,"onupdate",(function(t){if(this.element){var e=this.element.querySelectorAll("span.TagsInput-tag");e&&e.forEach((function(t){var e=t.firstChild;if(e){var o=e.textContent.trim(),r=a().store.getBy("tags","name",o);if(r){var l=r.data.attributes;l.textColor.length>0&&(e.classList.remove("colored"),e.firstChild.style.color=l.textColor,e.style.color=l.color)}}}))}})),(0,o.extend)(f().prototype,"onupdate",(function(){this.element&&this.element.querySelectorAll("span.TagLabel.colored").forEach((function(t){var e=t.textContent.trim(),o=a().store.getBy("tags","name",e);if(o){var r=o.data.attributes;r.textColor.length>0&&(t.classList.remove("colored"),t.firstChild.style.color=r.textColor,t.firstChild.style.backgroundColor=r.color)}}))})),(0,o.extend)(g().prototype,"oncreate",(function(){if(this.element)for(var t,e=this.element.querySelectorAll(".TagLabel"),o=0;o<e.length;o++){var r=e[o],l=r.textContent.trim(),s=a().store.getBy("tags","name",l);if(!s)return;var c=s.data.attributes;if(0===o){if(0===c.textColor.length)break;if("flarum_vanilla"===c.discussionHeroColorMode)break;switch(t=c,this.element.style.removeProperty("--hero-bg"),this.element.classList.remove("DiscussionHero--colored"),t.discussionHeroColorMode){case"primary_bg_tag_full_color":var n=getComputedStyle(this.element).getPropertyValue("--primary-color"),i=getComputedStyle(this.element).getPropertyValue("--secondary-color");this.element.style.backgroundColor=n,this.element.querySelector(".DiscussionHero-title").style.color=i;break;case"tag_text_as_bg_tag_full_color":this.element.style.backgroundColor=c.color,this.element.querySelector(".DiscussionHero-title").style.color=c.textColor;break;case"tag_bg_as_bg_tag_full_color":this.element.style.backgroundColor=c.textColor,this.element.querySelector(".DiscussionHero-title").style.color=c.color}}if(c.textColor.length>0)switch(t.discussionHeroColorMode){case"primary_bg_tag_full_color":case"tag_bg_as_bg_tag_full_color":r.classList.remove("colored"),r.firstChild.style.color=c.textColor,r.style.backgroundColor=c.color;break;case"tag_text_as_bg_tag_full_color":r.classList.remove("colored"),r.firstChild.style.color=c.color,r.style.backgroundColor=c.textColor}}})),(0,o.extend)(b().prototype,"oncreate",(function(){this.element&&this.attrs&&"tagsAdded"in this.attrs&&this.element.querySelectorAll("a.TagLabel.colored").forEach((function(t){if(t.attributes&&"object"==typeof t.attributes.href){var e=t.attributes.href.value.replace("/t/",""),o=a().store.getBy("tags","slug",e);if(o){var r=o.data.attributes;o.data.attributes.textColor.length>0&&(t.classList.remove("colored"),t.firstChild.style.color=r.textColor,t.style.color=r.color)}}}))}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map